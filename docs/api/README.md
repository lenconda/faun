---
order: 1
toc: 'menu'
title: 'API References'
nav:
  title: 'API'
  order: 1
---

# API

## Methods

### `Faun.prototype.registerSubApplications(config, hooks?)`

Register sub-applications configuration, and define lifecycle hook handlers.

- Parameters
  - `config`: `SubApplicationsType`. Required, an array stores sub-applications configuration
  - `hooks`: `IFaunLifecycleHooks`. Optional, a key-value pair defines lifecycle handlers, see [Lifecycle Hooks](#lifecycle-hooks) for detail
- Types
  - `SubApplicationsType`
    - `Array<ISubApplicationConfig>`
  - `ISubApplicationConfig`
    - `name`: `string`. Conditionally optional, defines the name of current sandbox. If `useCSSPrefix` is `true`, it will be required
    - `entry`: `ISubApplicationEntry`. Optional, defines sandbox's JavaScript and CSS entries
    - `activeWhen`: `SubApplicationActiveRuleType`. Required, the active rule for sandbox. When the pathname matches current sandbox's active rule, the sandbox will be mount
    - `container`: `SubApplicationContainerType`. Required, the mount point ID or `HTMLElement` DOM node instance for current sub-application
    - `useCSSPrefix`: `boolean`. Optional, default `false`. By default, Faun will set the `name`'s value as `data-f-*` attribute to container. e.g. `<div data-f-i8zjUoZ6__app1></div>`
    - `assetPublicPath`: `SubApplicationAssetPublicPathType`. Optional, when the [`publicPath`](https://webpack.js.org/guides/public-path/) of the sub-application is not the absolute path, such as `/` or `./`, `assetURLMapper` will help to add the proper prefix. e.g. `url => '//example.com/foo' + url` can add `//example.com/foo` to all of the chunked assets: `/0.chunk.js` -> `//example.com/foo/0.chunk.js`
    - `assetMatchers`: `SubApplicationAssetMatchersType`. Optional, since Faun only captures `<script>` and `<link>` elements, there are other elements, like `<img>` also needs rewrite. This option helps adding custom elements and attributes to rewrite `publicPath`
    - `preserveChunks`: `boolean`. Optional, default `false`, determine deleting chunked assets when unmounting or not
    - `extra`: `SubApplicationExtraType`. Optional, extra props for sandbox, when JavaScript entry is an executor, it will be passed as a parameter to the executor
    - `cleanDOMWhenUnmounting`: `boolean`. Optional, default `false`, determine set container's `innerHTML` to an empty string or not when unmounting
  - `ISubApplicationEntry`
    - `scripts`: `Array<string>`. Optional, default `null`. JavaScript resource URLs for current sub-application
    - `styles`: `Array<string>`. Optional, default `null`. CSS resource URLS for current sub-application
  - `SubApplicationActiveRuleType`
  - `SubApplicationContainerType`
  - `SubApplicationAssetPublicPathType`
  - `SubApplicationAssetMatchersType`
  - `SubApplicationExtraType`
    - `Record<string, any>`

### `Faun.prototype.run()`

Starts the Faun instance. When all of the configurations are finished, it should be invoked.

### `Faun.prototype.history` & `Faun.history`

`history` is an instance of [ReactTraining/history](https://github.com/ReactTraining/history) generated by `createBrowserHistory`, check out the documentation [here](https://github.com/ReactTraining/history/blob/master/docs/api-reference.md).

### `Faun.prototype.addGlobalDependence(name, dep)`

- Parameters
  - `name`: `string`. Required, the name for current dependence. The dependence will be added to `window` as a global variable: `window[name] = dep`
  - `dep`: `any`. Required, could be any thing. It could be accessed by `window[name]`

### `Faun.prototype.use(plugin, options?)`

Add a plugin to `Faun.prototype`.

- Parameters
  - `plugin`: `IPlugin`. Required, pass an plugin with type of `IPlugin`, the plugin should be injected into `Faun.prototype`
  - `options`: `Record<string, any>`. Optional, pass the options for current plugin
- Types
  - `IPlugin`
    - `install`: `(Faun: Faun) => any`. Required, `install` method should be implemented in all plugins, cause the plugin system will call `install` method when installing plugins

### `Faun.prototype.events`

#### `emit(key, data?)`

Fire a specified event, and call all of its handlers.

- `key`: `string`. Required, name of event that want to be fired
- `data`: `any`. Optional, data passed to the event handler

#### `on(key, callback)` :id=doc-events-on

Add an event handler to a specified event.

- `key`: `string`. Required, name of event
- `callback`: `(data?) => any`. Required, event handler

#### `off(key, callback)`

Remove specified callback of specified event

- `key`: `string`. Required, name of event
- `callback`: `(data?) => any`. Required, traverse all the handlers of specified event, in the meantime remove the specified callback

#### `has(key, callback)`

- `key`: `string`. Required, name of event
- `callback`: `(data?) => any`. Required, traverse all the handlers of specified event, in the meantime find the specified callback and return it

### `Faun.prototype.store`

#### `set(key, value)`

Set a record to store.

- `key`: `string`. Required, name of a store record
- `value`: `any`. Required, value of a store record

#### `get(key)`

Get a record to store.

- `key`: `string`. Required, name of a store record

## Lifecycle Hooks

### `loading(pathname)`

Be executed when loading a new sub-application.

- Parameters
  - `pathname`: `string`. Current top-level pathname

### `loaded(pathname)`

Be executed when a new sub-application is successfully loaded.

- Parameters
  - `pathname`: `string`. Current top-level pathname

### `mounted(pathname, sandbox)`

Be executed when a new sub-application is successfully mounted.

- Parameters
  - `pathname`: `string`. Current top-level pathname
  - `sandbox`: `Sandbox`. Sandbox that currently mounted
- Types
  - `Sandbox`

### `beforeUnmount(prev, next)`

Be executed when current sub-application will be unmounted.

- Parameters
  - `prev`: `string`. Current top-level pathname
  - `next`: `string`. Next top-level pathname

### `mounted(pathname, sandbox)`

Be executed when current sub-application is successfully unmounted.

- Parameters
  - `prev`: `string`. Current top-level pathname
  - `next`: `string`. Next top-level pathname
  - `sandbox`: `Sandbox`. Sandbox that currently mounted
- Types
  - `Sandbox`

## `FaunProps`

## `Sandbox`
